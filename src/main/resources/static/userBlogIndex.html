<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link href="css/userBlogIndex.css" rel="stylesheet">
    <link href="css/indexTop.css" rel="stylesheet">
    <link href="css/indexBottom.css" rel="stylesheet">
</head>
<script src="js/vue.min.js"></script>
<script src="js/jquery-3.4.1.js"></script>
<body>
    <div class="top">
    <div class="w">
        <div class="logo">
            <img src="images/blogIndex/logo.png">
        </div>
        <div class="nav">
            <li><a href="blogIndex.html">首页</a></li>
            <li><a href="blogIndex.html">博客</a></li>
            <li><a href="blogIndex.html">下载</a></li>
            <li><a href="blogIndex.html">会员</a></li>
            <li><a href="blogIndex.html">APP</a></li>
            <li><a href="blogIndex.html">论坛</a></li>
            <li><a href="blogIndex.html">商城</a></li>
            <li><a href="blogIndex.html">问答</a></li>
            <li><a href="blogIndex.html">课程</a></li>
            <li><a href="blogIndex.html">客服</a></li>
        </div>
        <form id="search">
            <div class="searchtext">
                <input type="text" id="searchtext" value="搜索框">
            </div>
            <input type="submit" class="searchbutton" value="搜索">
        </form>
        <div class="write">
            <a href="#">
                写&nbsp;博&nbsp;客
            </a>
        </div>
        <div class="login">
            <!--                <li><a href="blogIndex.html">登录</a></li>-->
            <!--                <li><a href="blogIndex.html">注册</a></li>-->
            <li><a href="#">消息</a></li>
            <a href="userInfoIndex.html">
                <div class="loginheadpic"></div>
            </a>
        </div>
    </div>
</div>
    <div class="main">
        <div class="w">
            <div class="leftinfo">
                <div class="userinfo">
                    <div class="userpic">
                        <img src="images/headpic.jpg">
                    </div>
                    <div class="username">
                        <span>DCW</span>
                    </div>
                </div>
                <div class="someinfo"  id="vue_fourinfo">
                    <div class="fourinfo">
                        <li>博客</li>
                        <li>{{blogCount}}</li>
                    </div>
                    <div class="fourinfo">
                        <li>关注</li>
                        <li>{{blogerCount}}</li>
                    </div>
                    <div class="fourinfo">
                        <li>粉丝</li>
                        <li>{{fansCount}}</li>
                    </div>
                    <div class="fourinfo">
                        <li>评论</li>
                        <li>0</li>
                    </div>
                </div>
                <div class="manageBlog">
                    <a href="blogManage.html"><li>管理博客</li></a>
                </div>
                <div class="leftbottom">
                    <img src="images/blogIndex/leftbottom.png">
                </div>
            </div>
            <div class="blog" id="vue_blog">
                <li v-for="(b , index) in blogs">
                    <div class="blogtitle">
                        文章标题:{{b.blogTitle}}
                    </div>
                    <div class="bloginfo">
                        <div class="blogcontent">
                            文章部分内容:{{b.blogContent}}
                        </div>
                        <div class="blogauthor">
                            <div class="authorpic">
                                头像:{{userinfo.userPic}}
                            </div>
                            <div class="authorname">
                                作者用户名:{{userinfo.realName}}
                            </div>
                            <div class="blogreadnum">
                                博客阅读量 {{b.blogReadNum}} 丨<a href="#">评论</a>
                            </div>
                        </div>
                    </div>
                </li>
            </div>
        </div>
    </div>
</body>
<script>
    var userId = 0;
    var vueblog = new Vue({
        el:"#vue_blog",
        data:{
            blogs:[],
            userinfo:{}
        }
    });
    var vuefourinfo = new Vue({
        el:"#vue_fourinfo",
        data:{
            blogCount:0,
            blogerCount:0,
            fansCount:0,
        }
    })

    $(function () {
        $.ajax({
            url:"http://localhost:8080/getUserId",
            type:"get",
            dataType:"json",
            success:function (data) {
                userId = data;
                $.ajax({
                    url:"http://localhost:8080/selectByUserinfoGetBlog",
                    type:"post",
                    data:{"userId":userId},
                    dataType:"json",
                    success:function (data) {
                        vueblog.userinfo={
                            realName:data.realName,
                            userSex:data.userSex,
                            userBirthday:data.userBirthday,
                            userPic:data.userPic,
                            userCreateTime:data.userCreateTime,
                        };
                        vuefourinfo.blogCount = data.blogList.length;
                        for(var i = 0 ; i<data.blogList.length;i++){
                            vueblog.blogs.push({
                                blogTitle:data.blogList[i].blogTitle,
                                blogCreateTime:data.blogList[i].blogCreateTime,
                                blogPubType:data.blogList[i].blogPubType,
                                blogReadNum:data.blogList[i].blogReadNum,
                                blogContent:data.blogList[i].blogContent,
                            })
                        }
                    }
                });
                $.ajax({
                    url:"http://localhost:8080/selectBlogerCount",
                    type:"get",
                    data:{"fansId":userId},
                    dataType:"json",
                    success:function (data){
                        vuefourinfo.blogerCount = data;
                    }
                });
                $.ajax({
                    url:"http://localhost:8080/selectFansCount",
                    type:"get",
                    data:{"blogerId":userId},
                    dataType:"json",
                    success:function (data){
                        vuefourinfo.fansCount = data;
                    }
                })
            }
        });
    })
</script>
</html>